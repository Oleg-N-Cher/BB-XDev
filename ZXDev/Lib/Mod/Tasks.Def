MODULE Tasks; (** non-portable *)

(**
  ERRORS:
    23 "Invalid stream" - Yield called in "main" task
*)

TYPE
  Context = RECORD
    SP, next: INTEGER;
    (* stack: ARRAY N OF BYTE; *)
    IX, PC, _RETURN: INTEGER;
  END;

  Tiny   * = RECORD (Context) stack: ARRAY  40 OF BYTE END;
  Small  * = RECORD (Context) stack: ARRAY  60 OF BYTE END;
  Medium * = RECORD (Context) stack: ARRAY  80 OF BYTE END;
  Large  * = RECORD (Context) stack: ARRAY 100 OF BYTE END;
  Huge   * = RECORD (Context) stack: ARRAY 120 OF BYTE END;

PROCEDURE Spawn* ((**VAR*) ctx: Context; proc: PROCEDURE); END Spawn;
PROCEDURE Id* (ctx: Context): INTEGER; END Id;
PROCEDURE MyId* (): INTEGER; END MyId;
PROCEDURE Run* (): SHORTINT; END Run;
PROCEDURE Yield* ; END Yield;

END Tasks.
